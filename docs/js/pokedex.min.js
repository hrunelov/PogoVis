/*! PogoVis v0.0.1 | (c) 2020 Hannes RunelÃ¶v | MIT License |  */
const TYPE_COLORS={bug:"#99c32f",dark:"#656776",dragon:"#0970bb",electric:"#f7da5c",fairy:"#ffaef0",fighting:"#d5425f",fire:"#fea153",flying:"#9bb3e1",ghost:"#626dbd",grass:"#5ebe67",ground:"#d68e5e",ice:"#7cd2c7",normal:"#919aa1",poison:"#b961cf",psychic:"#fc8684",rock:"#cbbd8e",steel:"#5496a2",water:"#5eaadc"};var pokedex;class Pokedex extends JSONAssignedObject{constructor(e,t,s){super(e),pokedex=this;let o=[],n=[],i={fast:[],charged:[]},r=[];for(let t of e.types)n.push(new Type(t));this.types=n;for(let e of this.types)for(let t of e.effectiveness){const e=t;for(let s of this.types.filter(t=>t.key===e.defendingType))t.defendingType=s}for(let t of e.moves.fast)i.fast.push(new FastMove(t));for(let t of e.moves.charged)i.charged.push(new ChargedMove(t));this.moves=i;for(let t of e.items)r.push(Object.assign(new Item,t));this.items=r;for(let t of e.pokemon)o.push(new Pokemon(t));this.pokemon=o;let f=function(e,o){let n=this.pokemon[e],i=n.forms[o];for(let e of i.evolutions){const t=e;for(let s of this.pokemon.filter(e=>e.key===t.pokemon))for(let o of s.forms.filter(e=>e.key===t.form))e.descendant=o;delete e.pokemon,delete e.form}let r=function(){++o===n.forms.length&&(++e,o=0,n.forms.length>1&&t(e/this.pokemon.length)),e<this.pokemon.length?f(e,o):(deepFreeze(this),s())}.bind(this);if(1===n.forms.length)return i.image=i.key,void r();let a=new Image;a.onload=function(){i.image=i.key,r()},a.onerror=function(){i.image=n.forms[0].key,r()},a.src=POKEMON_IMG_PATH+i.key+IMG_EXTENSION}.bind(this);f(0,0)}}class Type extends JSONAssignedObject{get counterEffectiveness(){let e=[];for(let t of pokedex.types)e.push({attackingType:t,damageMultiplier:t.effectiveness.find(e=>e.defendingType.key===this.key).damageMultiplier});return e}get color(){return TYPE_COLORS[this.key]}}class FastMove extends JSONAssignedObject{constructor(e){super(e),this.type=pokedex.types.find(e=>e.key===this.type)}}class ChargedMove extends JSONAssignedObject{constructor(e){super(e),this.type=pokedex.types.find(e=>e.key===this.type)}}class Item extends JSONAssignedObject{}class Pokemon extends JSONAssignedObject{constructor(e){super(e);let t=[];for(let s of e.forms){let e=new Form(s);if(e.pokemon=this,!e.description){const t=this.description;delete e.description,Object.defineProperty(e,"description",{get:()=>t})}t.push(e)}this.forms=t}}class Form extends JSONAssignedObject{constructor(e){super(e);let t=[];for(let e of this.types){const s=e;t.push(pokedex.types.find(e=>e.key===s))}this.types=t;for(let e of this.movePool.fast){const t=e;e.move=pokedex.moves.fast.find(e=>e.key===t.move)}for(let e of this.movePool.charged){const t=e;e.move=pokedex.moves.charged.find(e=>e.key===t.move)}for(let e of this.evolutions){const t=e;e.requirements.item&&(e.requirements.item=pokedex.items.find(e=>e.key===t.requirements.item))}}get counterEffectiveness(){let e=[];for(let t of pokedex.types)e.push({attackingType:t,damageMultiplier:1});for(let t of this.types)for(let s of t.counterEffectiveness){const t=s;e.find(e=>e.attackingType.key===t.attackingType.key).damageMultiplier*=t.damageMultiplier}return e}get ancestor(){for(let e of pokedex.pokemon)for(let t of e.forms)if(void 0!==t.evolutions.find(e=>e.descendant.key===this.key))return t}get firstAncestor(){let e=this;for(;void 0!==e.ancestor;e=e.ancestor);return e}sameTyping(e,t){if(this.types.length!==e.types.length)return!1;let s=this.types[0].key===e.types[0].key;return 1===this.types.length?s:s&&this.types[1].key===e.types[1].key||!t&&this.types[0].key===e.types[1].key&&this.types[1].key===e.types[0].key}}function getTypeSplitColor(e,t,s){let o=mixColors("#000",e[0].color,s);if(1==e.length)return o;{let n=mixColors("#000",e[1].color,s);return splitColor("to bottom",o,n,t)}}function getAverageBaseStats(){let e={attack:0,defense:0,stamina:0},t=0;for(let s of pokedex.pokemon)for(let o of s.forms)e.attack+=o.baseStats.attack,e.defense+=o.baseStats.defense,e.stamina+=o.baseStats.stamina,++t;return e.attack/=t,e.defense/=t,e.stamina/=t,e}