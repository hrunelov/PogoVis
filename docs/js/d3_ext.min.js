/*! PogoVis v0.0.1 | (c) 2020 Hannes Runelöv | MIT License |  */
var heights={},uid=0;d3.selection.prototype.listData=function({tag:t="div",data:e=[],key:a=(t=>t),horizontal:i=!1,hideContent:n=!0,fade:r=!0,waitForExit:s=!1,duration:o=TRANSITION_DURATION_MEDIUM,delay:l=0,onexit:d=(()=>{}),onupdate:c=(()=>{}),onenter:p=(()=>{})}={}){const u="list-item-wrapper";let h,f,y;f=this.selectAll("."+u+":not(.exiting)").data(e,a),h=f.exit().classed("exiting",!0),(function(t){let e=[];for(let a of t)for(let t of a.nodes())e.push(t);let n=e.reduce((function(t,e){return t[a(d3.select(e).data()[0])]=[i?e.offsetLeft:e.offsetTop,null],t}),{});for(let e of t)e.order();for(let t of e)n[a(d3.select(t).data()[0])][1]=i?t.offsetLeft:t.offsetTop;for(let t of e){let e=n[a(d3.select(t).data()[0])],r=e[0]-e[1];0!=r&&d3.select(t).interrupt("reorder").style("transform","translate"+(i?"X":"Y")+"("+r+"px)").transition("reorder").duration(o).style("transform","translate"+(i?"X":"Y")+"(0px)")}})([f,h]),y=f.enter().append(t).classed(u,!0).classed("hide-content",n);let m=t=>l,g=t=>l+(s&&!h.empty()?o:0),T=i?"width":"height";return h.empty()||(d.bind(h.node())(h,m),h.interrupt("tween").transition("tween").duration(o).delay(m).style(T,"0px").style("opacity",r?0:1).remove()),f.empty()||c.bind(f.node())(f,t=>l+(!s||h.empty()||y.empty()?0:o)),y.empty()||(p.bind(y.node())(y,g),y.style(T,"0px").style("opacity",r?0:1).transition("tween").duration(o).delay(g).style(T,null).style("opacity",1)),this.selectAll("."+u)},d3.selection.prototype.at=function(t){return this.filter((e,a)=>a===t)},d3.selection.prototype.appendSvg=function(t,e){return this.append("svg").style("width",(function(e,a){return t?t+(isNumber(t)?"px":""):null})).style("height",(function(t,a){return e?e+(isNumber(e)?"px":""):null}))},d3.selection.prototype.selectParentWithTag=function(t){let e;for(t=t.toLowerCase(),e=this.node();e&&e.tagName!==t;e=e.parentNode);return e?d3.select(e):null},d3.selection.prototype.selectParentWithClass=function(t){let e;for(e=this.node();e&&!d3.select(e).classed(t);e=e.parentNode);return e?d3.select(e):null},d3.transition.prototype.interp=function(t,e,a){return this.tween("interp",(function(){return function(i){a((1-i)*t+i*e)}}))},d3.selection.prototype.delay=function(t){return this.transition("delay").delay(t)},d3.selection.prototype.zoomIn=function({duration:t=TRANSITION_DURATION_MEDIUM,delay:e=0,ease:a=d3.easeQuad,fade:i=!1}={}){let n=this.style("transform","scale(0,0)");return i&&(n=n.style("opacity",0)),n=n.transition().duration(t).delay(e).ease(a).style("transform","scale(1,1)"),i&&(n=n.style("opacity",1)),this},d3.selection.prototype.zoomInY=function({duration:t=TRANSITION_DURATION_MEDIUM,delay:e=0,ease:a=d3.easeQuad,fade:i=!1}={}){let n=this.style("transform","scaleY(0)");return i&&(n=n.style("opacity",0)),n=n.transition().duration(t).delay(e).ease(a).style("transform","scaleY(1)"),i&&(n=n.style("opacity",1)),this},d3.selection.prototype.fadeIn=function({duration:t=TRANSITION_DURATION_MEDIUM,delay:e=0}={}){return this.style("opacity",0).transition().duration(t).delay(e).style("opacity",1),this},d3.selection.prototype.zoomOut=function({duration:t=TRANSITION_DURATION_MEDIUM,delay:e=0,ease:a=d3.easeQuad,fade:i=!1}={}){let n=this.transition().duration(t).delay(e).ease(a).style("transform","scale(0,0)");return i&&(n=n.style("opacity",0)),this},d3.selection.prototype.zoomOutY=function({duration:t=TRANSITION_DURATION_MEDIUM,delay:e=0,ease:a=d3.easeQuad,fade:i=!1}={}){let n=this.transition().duration(t).delay(e).ease(a).style("transform","scaleY(0)");return i&&(n=n.style("opacity",0)),this},d3.selection.prototype.fadeOut=function({duration:t=TRANSITION_DURATION_MEDIUM,delay:e=0}={}){return this.transition().duration(t).delay(e).style("opacity",0),this};var barProps=d3.local();d3.selection.prototype.appendBar=function({width:t=null,height:e=null,background:a=null,shadow:i=!1,max:n=100,minorTickStep:r=0,minMinorTick:s=0,maxMinorTick:o=100,majorTickStep:l=0,minMajorTick:d=0,maxMajorTick:c=100,minorTickWidth:p=2,minorTickOpacity:u=.33,majorTickWidth:h=2,majorTickOpacity:f=1,labels:y=null,labelAnchor:m="middle",keepLabelsInside:g=!0,classes:T=[]}={}){t=functionize(t),e=functionize(e),a=functionize(a),r=functionize(r),s=functionize(s),o=functionize(o),l=functionize(l),d=functionize(s),c=functionize(c),y=functionize(y);let b=this.append("div").classed("bar-container",!0).style("width",e=>t(e)?t(e)+"px":null).style("height",t=>e(t)?e(t)+"px":null);for(let t of T)b.classed(t,!0);let I=t=>null!==y(t)?28:0;b.style("height",(function(t){return d3.select(this).node().offsetHeight+I(t)+"px"})),b.each((function(t){barProps.set(this,{max:n,minorTickStep:r(t),minMinorTick:s(t),maxMinorTick:o(t),majorTickStep:l(t),minMajorTick:d(t),maxMajorTick:c(t),minorTickWidth:p,minorTickOpacity:u,majorTickWidth:h,majorTickOpacity:f,labels:y(t),labelAnchor:m,keepLabelsInside:g,barWidth:d3.select(this).node().offsetWidth,barHeight:d3.select(this).node().offsetHeight,labelHeight:I(t)})}));let k=b.appendSvg("100%","100%"),x=k.append("filter").attr("id","shadow");x.append("feOffset").attr("dx",0).attr("dy",0).attr("in","SourceAlpha").attr("result","offOut"),x.append("feGaussianBlur").attr("in","offOut").attr("stdDeviation",1).attr("result","blurOut"),x.append("feBlend").attr("in","SourceGraphic").attr("in2","blurOut").attr("mode","normal");let M=k.append("g"),N=M.append("rect").classed("bar-background",!0).attr("x",0).attr("y",0).attr("width","100%").style("fill",t=>a(t)?a(t):null);N.attr("height",(t,e)=>k.at(e).node().clientHeight-I(t)),i&&N.attr("filter","url(#shadow)");let O=k.append("mask").attr("id",(t,e)=>"ticks"+uid+++e);return M.attr("mask",(t,e)=>"url(#"+O.at(e).attr("id")+")"),O.append("rect").attr("x",0).attr("y",0).attr("width","100%").attr("height","100%").style("fill","#000"),O.append("rect").classed("bar-mask",!0).attr("x",0).attr("y",0).attr("width","100%").style("fill","#fff").attr("height",(t,e)=>k.at(e).node().clientHeight-I(t)),b.setBarTickStep({minorTickStep:t=>r(t),majorTickStep:t=>l(t),labels:t=>y(t)}),b},d3.selection.prototype.setBarTickStep=function({minorTickStep:t=null,majorTickStep:e=null,labels:a=null}={}){let i=this.select("svg").select("mask"),n=function(t,e){return t/barProps.get(this).max*e*barProps.get(this).barWidth};if(null!==t&&(t=functionize(t),this.each((function(e){barProps.get(this).minorTickStep=t(e)})),i.selectAll(".minor").remove(),i.selectAll(".minor").data((function(e){return t(e)?new Array(Math.floor(Math.min(barProps.get(this).maxMinorTick,barProps.get(this).max-1e-4)/t(e))).fill(t(e)):[]})).enter().append("line").classed("bar-tick",!0).classed("minor",!0).attr("x1",(function(t,e){return n.bind(this)(t,e+1)})).attr("y1",0).attr("x2",(function(t,e){return n.bind(this)(t,e+1)})).attr("y2","100%").style("stroke-width",(function(){return barProps.get(this).minorTickWidth})).style("opacity",(function(){return barProps.get(this).minorTickOpacity}))),null!==e){e=functionize(e),this.each((function(t){barProps.get(this).majorTickStep=e(t)})),i.selectAll(".major").remove(),i.selectAll(".bar-label").remove();let t=function(t){let e=barProps.get(this).majorTickStep;return e?new Array(Math.floor(Math.min(barProps.get(this).maxMajorTick,barProps.get(this).max-1e-4)/e)).fill(e):[]};i.selectAll(".major").data(t).enter().append("line").classed("bar-tick",!0).classed("major",!0).attr("x1",(function(t,e){return n.bind(this)(t,e+1)})).attr("y1",0).attr("x2",(function(t,e){return n.bind(this)(t,e+1)})).attr("y2","100%").style("stroke-width",(function(){return barProps.get(this).majorTickWidth})).style("opacity",(function(){return barProps.get(this).majorTickOpacity}))}if(a){a=functionize(a),this.each((function(t){barProps.get(this).labels=a(t)}));let t=this.select("svg");t.selectAll(".bar-label").remove();let e=function(t){if(!a(t))return[];let e=barProps.get(this).majorTickStep;return e?new Array(Math.floor(Math.min(barProps.get(this).maxMajorTick,barProps.get(this).max)/e)+1).fill(e):[]};t.selectAll(".bar-label").data(e).enter().append("text").classed("bar-label",!0).classed("numeric-label",!0).attr("text-anchor",(function(){return barProps.get(this).labelAnchor})).text((function(t,e){let a=barProps.get(this).labels;return(a[e]?a[e]:t*e).toString().replace(1/0,"∞")})).attr("x",(function(t,e){let a=n.bind(this)(t,e);if(!barProps.get(this).keepLabelsInside)return a;let i,r,s=d3.select(this).node().getBBox().width;switch(barProps.get(this).labelAnchor){case"start":i=0,r=s;break;case"middle":r=i=.5*s;break;case"end":i=s,r=0}return Math.min(a-Math.min(0,a-i),barProps.get(this).barWidth-r)})).attr("y",(function(){return barProps.get(this).barHeight-barProps.get(this).labelHeight+20}))}return this},d3.selection.prototype.appendBarValue=function({color:t=null,shadow:e=!1,value:a=.5,startValue:i=0,label:n=!1,fadeFromZero:r=!1,duration:s=TRANSITION_DURATION_MEDIUM,delay:o=0}={}){let l=this.select("svg"),d=l.select("g").append("rect").classed("bar-value",!0).attr("x",0).attr("y",0).attr("height","100%");return t&&d.style("fill",t),n&&l.append("text").classed("bar-value-label",!0).classed("numeric-label",!0).attr("text-anchor","middle").attr("y",(function(){return barProps.get(this).barHeight-barProps.get(this).labelHeight+20})),d.setBarValue({value:r?0:a,startValue:r?0:i,immediate:!0}),r&&d.setBarValue({value:a,startValue:i,immediate:!1,duration:s,delay:o}),e&&d.attr("filter","url(#shadow)"),d},d3.selection.prototype.setBarValue=function({value:t=.5,startValue:e=0,immediate:a=!1,duration:i=TRANSITION_DURATION_MEDIUM,delay:n=0,ease:r=d3.easeQuad}={}){t=functionize(t),e=functionize(e);let s=this.selectParentWithTag("svg").select(".bar-value-label");function o(){this.attr("x",(function(t){return e(t)/barProps.get(this).max*100+"%"})).attr("width",(function(a){let i=(t(a)-e(a))/barProps.get(this).max*100;return(i===1/0||isNaN(i)?0:i)+"%"}))}function l(){this.attr("x",(function(a,i){let n,r,o=(t(a)-e(a))/barProps.get(this).max*barProps.get(this).barWidth,l=s.at(i).node().getBBox().width;return r=n=.5*l,Math.min(o-Math.min(0,o-n),barProps.get(this).barWidth-r)}))}return s.text(t),a?(this.interrupt("fade1").interrupt("fade2"),o.bind(this)(),l.bind(s)()):(o.bind(this.transition("fade1").duration(i).delay(n).ease(r))(),l.bind(s.transition("fade2").duration(i).delay(n).ease(r))()),this};var spiderProps=d3.local();function fadeIn(t,e){e=e||0,t.style("opacity",0).transition().duration(TRANSITION_DURATION_MEDIUM).delay(e).style("opacity",1)}function fadeInIcon(t,e){e=e||0,t.style("transform","scale(0,0)").transition().duration(TRANSITION_DURATION_MEDIUM).delay(e).ease(d3.easeBackOut).style("transform","scale(1,1)")}function fadeOutIcon(t,e){e=e||0,t.interrupt().transition().duration(TRANSITION_DURATION_MEDIUM).delay(e).ease(d3.easeBackIn).style("transform","scale(0,0)")}function fadeInText(t,e){e=e||0,t.style("opacity",0).transition().duration(TRANSITION_DURATION_MEDIUM).delay(e).style("opacity",1)}function fadeOutText(t,e){e=e||0,t.interrupt().transition().duration(TRANSITION_DURATION_MEDIUM).delay(e).style("opacity",0)}function animateHeight(t,e,a){let i=d3.select(t);if(heights[t]){i.style("height","auto");const n=heights[t],r=i.node().clientHeight;i.style("height",n+"px"),heights[t]=r,a&&r<n?i.interrupt().style("height",r+"px"):i.transition().duration(e||TRANSITION_DURATION_MEDIUM).style("height",r+"px")}else heights[t]=i.node().clientHeight}d3.selection.prototype.appendSpiderChart=function({width:t=null,height:e=null,max:a=1,tick:i=.25,labels:n=["X","Y","Z"],anchors:r=null,anchorOffsets:s=null}={}){let o=n.length,l=this.append("div").classed("spider-container",!0),d=l.appendSvg(t,e);t=d.node().clientWidth,e=d.node().clientHeight,spiderProps.set(l,{width:t,height:e,max:a,tick:i,n:o,atoc:function(i,n){let r=d3.scaleLinear().domain([0,a]).range([0,.4*e]),s=Math.cos(i)*r(n),o=Math.sin(i)*r(n)*1;return{x:.5*t+s,y:.5*e-o}},makeLine:function(){let t=n.length;return d3.line().x((e,a)=>c.atoc(Math.PI/2+2*Math.PI*a/t,e).x).y((e,a)=>c.atoc(Math.PI/2+2*Math.PI*a/t,e).y).curve(d3.curveLinearClosed)}});let c=spiderProps.get(l),p=(d3.scaleLinear().domain([0,a]).range([0,.4*e]),[]);for(let t=i;t<=a;t+=i)p.push(t);for(let t of p)d.append("path").datum(new Array(o).fill(t)).attr("class",t<a?"spider-tick":"spider-tick-outer").attr("d",c.makeLine());if(!r){r=["middle"];for(let t=1;t<o;++t)t<o/2?r.push("end"):t==o/2?r.push("middle"):r.push("start")}s||(s=new Array(o).fill({x:0,y:0}));for(let i=0;i<o;++i){let l=n[i],p=Math.PI/2+2*Math.PI*i/o,u=c.atoc(p,a),h=c.atoc(p,a+.08*a);d.append("line").classed("spider-axis",!0).attr("x1",.5*t).attr("y1",.5*e).attr("x2",u.x).attr("y2",u.y),d.append("text").classed("spider-label",!0).attr("text-anchor",r[i]).attr("x",h.x+s[i].x).attr("y",h.y+s[i].y).text(l)}return l},d3.selection.prototype.appendSpiderChartData=function({strokeWidth:t=null,strokeColor:e=null,fillColor:a=null,data:i=[],fadeFromZero:n=!1,duration:r=TRANSITION_DURATION_MEDIUM,delay:s=0}={}){let o=spiderProps.get(this),l=this.select("svg").append("path").datum(i).classed("spider-shape",!0).attr("d",o.makeLine());return null!==t&&l.style("stroke-width",t+"px"),null!==e&&l.style("stroke",e),null!==a&&l.style("fill",a),spiderProps.set(l,o),l},d3.selection.prototype.setSpiderChartData=function({data:t=[],immediate:e=!1,duration:a=TRANSITION_DURATION_MEDIUM,delay:i=0}={}){let n=spiderProps.get(this);this.datum(t).transition().duration(i+a).ease(d3.easeQuadOut).attr("d",n.makeLine())},d3.selection.prototype.appendTypeIcon=function(t){return this.append("img").classed("type-icon",!0).attr("src",e=>"img/types/"+(t?t(e).key:e.key)+".svg")},d3.selection.prototype.appendPokemonImage=function({form:t=selectedForm,width:e=75,selected:a=!1,fadeDelay:i=0,fadeFrame:n=!0,fadeImage:r=!0,onclick:s=function(){}}={}){let o=this.append("div").classed("pokemon-image-wrapper",!0),l=o.append("div").classed("pokemon-image-frame",!0).style("height",e+"px").classed("selected",a),d=(l.style("border-color"),mixColors("#000",t.types[0].color,.2));l.style("width",e+"px").style("height",e+"px").style("transform",n&&i?"scaleY(0)":"").style("background",d);let c=l.append("img").classed("pokemon-image",!0).style("opacity",r&&i?0:1).attr("src",POKEMON_IMG_PATH+t.image+IMG_EXTENSION);r&&i&&c.transition().duration(TRANSITION_DURATION_MEDIUM).delay(i).style("opacity",1);let p=o.append("div").classed("pokemon-image-name",!0).classed("selected",a).text(t.pokemon.name).style("opacity",n?0:1);if(t.ancestor){let e=t.ancestor.evolutions.filter(e=>e.descendant.key===t.key)[0].evolutionType;e&&(e=e.split("_"),p.classed("two-lines",!0).html(capitalize(e[0])+"<br/>"+t.pokemon.name+(e[1]?" "+capitalize(e[1]):"")))}return a||o.append("button").attr("type","button").classed("pokemon-image-hot-area",!0).style("width",e+4+"px").style("height",e+32+"px").on("mouseover",(function(){l.classed("selected",!0),p.classed("selected",!0)})).on("mouseout",(function(){l.classed("selected",!1),p.classed("selected",!1)})).on("click",s),n&&i&&(l.transition().duration(TRANSITION_DURATION_MEDIUM).delay(i).ease(d3.easeBackOut).style("transform","scaleY(1)"),p.transition().duration(TRANSITION_DURATION_MEDIUM).delay(i).style("opacity",1)),o};