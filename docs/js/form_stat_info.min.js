/*! PogoVis v0.0.1 | (c) 2020 Hannes Runelöv | MIT License |  */
const cpCaps=[1500,2500,0];var baseStatChart,baseStatMax,baseStatData,statChart,statMax,statData,optimalStatsList,cpCap=cpCaps[0],ivValues={attack:0,defense:0,hp:0},ivSliderValues={attack:0,defense:0,hp:0};function updateStatInfo(t,e){let a;switch(d3.selectAll(".form-iv-min").setBarValue({value:selectedPokemon.untradeable?10:0}),t&&selectedPokemon.untradeable&&setIv({attack:Math.max(ivValues.attack,10),defense:Math.max(ivValues.defense,10),hp:Math.max(ivValues.hp,10)}),e&&(optimalStatsList=listOptimalStatsForCPCap(selectedForm,cpCap)),updateBaseStats(),updateStats(t),cpCap){case 1500:a=GREAT_COLOR;break;case 2500:a=ULTRA_COLOR;break;case 0:a=MASTER_COLOR}let s=a+"4",l=mixColors(a,"#fff",.5);d3.selectAll(".form-iv-value").transition("color").duration(TRANSITION_DURATION_MEDIUM).style("fill",a),d3.selectAll(".form-iv-bar").select("svg").select("g").select(".bar-background").transition("color").duration(TRANSITION_DURATION_MEDIUM).style("fill",s),d3.select("#form-stats-chart").select(".spider-container").select("svg").select(".spider-shape").transition("color").duration(TRANSITION_DURATION_MEDIUM).style("stroke",l).style("fill",s)}function updateBaseStats(){baseStatChart||(baseStatChart=d3.select("#form-basestats-chart").appendSpiderChart({height:"100%",max:500,tick:125,labels:["Stamina","Attack","Defense"],anchors:["middle","middle","middle"],anchorOffsets:[{x:0,y:0},{x:8,y:16},{x:-8,y:16}]}),baseStatData=baseStatChart.appendSpiderChartData({data:[0,0,0]})),baseStatData.setSpiderChartData({data:[selectedForm.baseStats.stamina,selectedForm.baseStats.attack,selectedForm.baseStats.defense]}),d3.select("#form-basestats-stamina").text(selectedForm.baseStats.stamina),d3.select("#form-basestats-attack").text(selectedForm.baseStats.attack),d3.select("#form-basestats-defense").text(selectedForm.baseStats.defense)}function updateStats(t,e){statChart||(statChart=d3.select("#form-stats-chart").appendSpiderChart({height:"100%",max:1,tick:.25,labels:["HP","Attack","Defense"],anchors:["middle","middle","middle"],anchorOffsets:[{x:0,y:0},{x:8,y:16},{x:-8,y:16}]}),statData=statChart.appendSpiderChartData({data:[0,0,0]}));let a;t?setIv((a=sortByStatProduct(optimalStatsList.list)[0]).iv):a=calculateOptimalStats(selectedForm,ivValues.attack,ivValues.defense,ivValues.hp,cpCap),statData.setSpiderChartData({data:[a.stats.hp/500,a.stats.attack/500,a.stats.defense/500]}),d3.select("#form-stats-hp").text(a.stats.hp),d3.select("#form-stats-attack").text(oneDecimal(a.stats.attack)),d3.select("#form-stats-defense").text(oneDecimal(a.stats.defense)),d3.select("#form-stats-caption").text("At ʟ"+a.level)}function ivBar(t){return d3.select("#form-iv-value-"+t)}function ivLabel(t){return d3.select("#form-iv-label-"+t)}function setIv(t){for(stat in ivValues=t,ivSliderValues=t,t)ivBar(stat).setBarValue({value:t[stat]}),ivLabel(stat).text(t[stat])}d3.selectAll(".form-league-tab").on("click",(function(t,e){d3.select(this).classed("selected")||(d3.selectAll(".form-league-tab").classed("selected",!1),d3.select(this).classed("selected",!0),cpCap=cpCaps[e],updateStatInfo(!1,!0))}));var lastMouseX,hoveredSlider=null,draggedSlider=null;let b=d3.selectAll(".form-iv-slider").on("mouseenter",(function(){mobile()||(hoveredSlider=this,d3.select(this).transition().duration(TRANSITION_DURATION_INSTANT).style("background","#4448"))})).on("mouseleave",(function(){mobile()||(hoveredSlider=null),draggedSlider!==this&&d3.select(this).transition().duration(TRANSITION_DURATION_INSTANT).style("background","#4440")})).call(d3.drag().on("start",(function(){draggedSlider=this,d3.dispatch("drag"),lastMouseX=d3.mouse(document.body)[0],d3.select(this).transition().duration(TRANSITION_DURATION_INSTANT).style("background","#4448")})).on("drag",(function(){let t,e=d3.select(this).attr("value");if(mobile()){let a=.1*(d3.mouse(document.body)[0]-lastMouseX);lastMouseX=d3.mouse(document.body)[0],t=Math.min(Math.max(ivSliderValues[e]+a,selectedPokemon.untradeable?10:0),15)}else{const e=4,a=296;t=Math.max(Math.round(15*Math.min(Math.max(0,(mouse(this).x-e)/(a-e)),1)),selectedPokemon.untradeable?10:0)}ivValues[e]=Math.round(t),ivSliderValues[e]=t,ivBar(e).setBarValue({value:Math.round(t),ease:d3.easeQuadOut,duration:TRANSITION_DURATION_INSTANT}),ivLabel(e).text(Math.round(t)),updateStatInfo(!1,!0)})).on("end",(function(){ivSliderValues=ivValues,draggedSlider=null,hoveredSlider!==this&&d3.select(this).transition().duration(TRANSITION_DURATION_INSTANT).style("background","#4440")}))).appendBar({max:15,majorTickStep:5,height:12,shadow:!0,classes:["form-iv-bar"]});b.appendBarValue({value:0}).classed("form-iv-value",!0).attr("id",(function(){return"form-iv-value-"+d3.select(this).selectParentWithClass("form-iv-slider").attr("value")})),b.appendBarValue({value:0}).classed("form-iv-min",!0);